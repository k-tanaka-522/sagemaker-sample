# SageMaker CloudFormation ã‚µãƒ³ãƒ—ãƒ«

ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã¯ã€AWS CloudFormationã‚’ä½¿ã£ã¦SageMakerãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç°¡å˜ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã‚µãƒ³ãƒ—ãƒ«ã§ã™ã€‚

## ğŸ¯ å†…å®¹

**SageMakerãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯**ã¨ã„ã†æ©Ÿæ¢°å­¦ç¿’ã®é–‹ç™ºç’°å¢ƒã‚’ã€AWSã‚¯ãƒ©ã‚¦ãƒ‰ä¸Šã«è‡ªå‹•ã§æ§‹ç¯‰ã§ãã¾ã™ã€‚

### ä½œæˆã•ã‚Œã‚‹ã‚‚ã®
- **Jupyter Notebookç’°å¢ƒ**ï¼šãƒ–ãƒ©ã‚¦ã‚¶ã§æ©Ÿæ¢°å­¦ç¿’ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦å®Ÿè¡Œã§ãã‚‹
- **å¿…è¦ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­å®š**ï¼šå®‰å…¨ã«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ç’°å¢ƒ
- **æ¨©é™è¨­å®š**ï¼šSageMakerãŒä»–ã®AWSã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹è¨­å®š

### æƒ³å®šã™ã‚‹åˆ©ç”¨è€…
- æ©Ÿæ¢°å­¦ç¿’ã‚’å§‹ã‚ãŸã„æ–¹
- AWSã®SageMakerã‚’è©¦ã—ã¦ã¿ãŸã„æ–¹
- CloudFormationã®åŸºæœ¬çš„ãªä½¿ã„æ–¹ã‚’å­¦ã³ãŸã„æ–¹

## ğŸš€ ä½¿ã„æ–¹ã‚³ãƒãƒ³ãƒ‰ï¼ˆç¶²ç¾…ç‰ˆï¼‰

### æº–å‚™
```bash
# 1. ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
git clone https://github.com/k-tanaka-522/sagemaker-sample.git
cd sagemaker-sample

# 2. AWSèªè¨¼ç¢ºèª
aws sts get-caller-identity
```

### ãƒ‡ãƒ—ãƒ­ã‚¤

#### åŸºæœ¬ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆåˆå¿ƒè€…å‘ã‘ï¼‰
```bash
# ã‚·ãƒ³ãƒ—ãƒ«ãª1ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ
aws cloudformation create-stack \
  --stack-name my-sagemaker-notebook \
  --template-body file://simple-stack.yaml \
  --parameters file://simple-parameters.json \
  --capabilities CAPABILITY_NAMED_IAM \
  --region ap-northeast-1

# å®Œäº†ã‚’å¾…ã¤
aws cloudformation wait stack-create-complete \
  --stack-name my-sagemaker-notebook \
  --region ap-northeast-1
```

#### è¤‡æ•°ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯
```bash
# 1ã¤ç›®
aws cloudformation create-stack \
  --stack-name sagemaker-notebook-first \
  --template-body file://simple-stack.yaml \
  --parameters ParameterKey=NotebookInstanceName,ParameterValue=dev-notebook \
  --capabilities CAPABILITY_NAMED_IAM \
  --region ap-northeast-1

# 2ã¤ç›®
aws cloudformation create-stack \
  --stack-name sagemaker-notebook-second \
  --template-body file://simple-stack.yaml \
  --parameters ParameterKey=NotebookInstanceName,ParameterValue=prod-notebook \
  --capabilities CAPABILITY_NAMED_IAM \
  --region ap-northeast-1
```

#### ãƒã‚¹ãƒˆã‚¹ã‚¿ãƒƒã‚¯ï¼ˆä¸Šç´šè€…å‘ã‘ï¼‰
```bash
# S3ãƒã‚±ãƒƒãƒˆä½œæˆ
aws s3 mb s3://$(aws sts get-caller-identity --query Account --output text)-cfn-templates --region ap-northeast-1

# ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
aws s3 cp templates/ s3://$(aws sts get-caller-identity --query Account --output text)-cfn-templates/sagemaker/templates/ --recursive --region ap-northeast-1

# ãƒ‡ãƒ—ãƒ­ã‚¤
aws cloudformation create-stack \
  --stack-name sagemaker-nested-example \
  --template-body file://main-stack.yaml \
  --parameters ParameterKey=NotebookInstanceName,ParameterValue=nested-notebook \
  --capabilities CAPABILITY_NAMED_IAM \
  --region ap-northeast-1
```

### ã‚¢ã‚¯ã‚»ã‚¹

#### URLå–å¾—
```bash
# ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†å¾Œã€ã‚¢ã‚¯ã‚»ã‚¹æƒ…å ±ã‚’å–å¾—
aws cloudformation describe-stacks \
  --stack-name my-sagemaker-notebook \
  --region ap-northeast-1 \
  --query 'Stacks[0].Outputs[*].[OutputKey,OutputValue]' \
  --output table
```

#### ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•
1. **AWSã‚³ãƒ³ã‚½ãƒ¼ãƒ«çµŒç”±ï¼ˆæ¨å¥¨ï¼‰**: ä¸Šè¨˜ã®`JupyterURL`ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ã
2. **ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹**: `JupyterLabURL`ã‚’ç›´æ¥ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ã

#### çŠ¶æ…‹ç¢ºèª
```bash
# ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã®çŠ¶æ…‹ç¢ºèª
aws sagemaker describe-notebook-instance \
  --notebook-instance-name my-first-sagemaker-notebook \
  --region ap-northeast-1 \
  --query '[NotebookInstanceStatus,Url]' \
  --output table
```

### ç®¡ç†

#### åœæ­¢ãƒ»å†é–‹
```bash
# åœæ­¢
aws sagemaker stop-notebook-instance \
  --notebook-instance-name my-first-sagemaker-notebook \
  --region ap-northeast-1

# å†é–‹
aws sagemaker start-notebook-instance \
  --notebook-instance-name my-first-sagemaker-notebook \
  --region ap-northeast-1
```

#### å‰Šé™¤

##### åŸºæœ¬å‰Šé™¤
```bash
# å˜ä¸€ã‚¹ã‚¿ãƒƒã‚¯å‰Šé™¤
aws cloudformation delete-stack \
  --stack-name my-sagemaker-notebook \
  --region ap-northeast-1
```

##### è¤‡æ•°å‰Šé™¤
```bash
# è¤‡æ•°ã®ã‚¹ã‚¿ãƒƒã‚¯ã‚’å€‹åˆ¥ã«å‰Šé™¤
aws cloudformation delete-stack --stack-name sagemaker-notebook-dev --region ap-northeast-1
aws cloudformation delete-stack --stack-name sagemaker-notebook-prod --region ap-northeast-1
```

##### ä¸€æ‹¬å‰Šé™¤
```bash
# sagemakeré–¢é€£ã‚¹ã‚¿ãƒƒã‚¯ã‚’å…¨ã¦å‰Šé™¤
for stack in $(aws cloudformation list-stacks \
  --region ap-northeast-1 \
  --query 'StackSummaries[?contains(StackName, `sagemaker`) && StackStatus != `DELETE_COMPLETE`].StackName' \
  --output text); do
  echo "Deleting stack: $stack"
  aws cloudformation delete-stack --stack-name $stack --region ap-northeast-1
done
```

#### çŠ¶æ…‹ç›£è¦–
```bash
# ãƒ‡ãƒ—ãƒ­ã‚¤çŠ¶æ…‹ç¢ºèª
aws cloudformation describe-stacks \
  --stack-name my-sagemaker-notebook \
  --region ap-northeast-1 \
  --query 'Stacks[0].StackStatus'

# ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–
watch -n 10 'aws cloudformation describe-stack-events \
  --stack-name my-sagemaker-notebook \
  --region ap-northeast-1 \
  --query "StackEvents[0:3].[Timestamp,ResourceType,ResourceStatus,ResourceStatusReason]" \
  --output table'
```

## ğŸ“Š ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        AWS Cloud                           â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    VPC                              â”‚   â”‚
â”‚  â”‚  (10.0.0.0/16)                                     â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚           Public Subnet                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚          (10.0.1.0/24)                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                             â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚      SageMaker Notebook             â”‚   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚                                     â”‚   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  - Jupyter Labç’°å¢ƒ                 â”‚   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  - ml.t3.medium                    â”‚   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  - æ©Ÿæ¢°å­¦ç¿’ãƒ©ã‚¤ãƒ–ãƒ©ãƒª               â”‚   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚        Security Group                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - HTTPSã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ (ãƒãƒ¼ãƒˆ443)           â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                IAM Role                             â”‚   â”‚
â”‚  â”‚  - SageMakerã®å®Ÿè¡Œæ¨©é™                             â”‚   â”‚
â”‚  â”‚  - S3ã€CloudWatchç­‰ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ HTTPS (443)
                                â”‚
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚   ã‚ãªãŸã®PC     â”‚
                      â”‚  ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰    â”‚
                      â”‚  Jupyteræ¥ç¶š     â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä½œæˆã•ã‚Œã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- **VPC**: ã‚ãªãŸå°‚ç”¨ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç’°å¢ƒ
- **ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤**: VPCã¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚’ç¹‹ãå‡ºå…¥ã‚Šå£
- **ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆ**: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªã‚¨ãƒªã‚¢
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—**: HTTPSï¼ˆãƒãƒ¼ãƒˆ443ï¼‰ã®ã¿è¨±å¯ã®ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«
- **IAMãƒ­ãƒ¼ãƒ«**: SageMakerãŒAWSã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ã†æ™‚ã®æ¨©é™
- **SageMakerãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯**: æ©Ÿæ¢°å­¦ç¿’ã®é–‹ç™ºç’°å¢ƒï¼ˆãƒ¡ã‚¤ãƒ³ï¼‰

## ğŸ’° æ–™é‡‘

### æƒ³å®šã‚³ã‚¹ãƒˆï¼ˆæ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ï¼‰
- **SageMakerãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ï¼ˆml.t3.mediumï¼‰**: ç´„ $0.06/æ™‚é–“
- **EBSã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ï¼ˆ20GBï¼‰**: ç´„ $0.05/æ—¥
- **ãã®ä»–ï¼ˆVPCã€NAT Gatewayç­‰ï¼‰**: ç´„ $0.05/æ—¥

### ğŸ’¡ ã‚³ã‚¹ãƒˆå‰Šæ¸›ã®ãƒã‚¤ãƒ³ãƒˆ
1. **ä½¿ã‚ãªã„æ™‚ã¯åœæ­¢**: ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’åœæ­¢ã™ã‚Œã°ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è²»ç”¨ã¯ç™ºç”Ÿã—ã¾ã›ã‚“
2. **ä¸è¦ã«ãªã£ãŸã‚‰å‰Šé™¤**: ã‚¹ã‚¿ãƒƒã‚¯å…¨ä½“ã‚’å‰Šé™¤ã™ã‚Œã°å…¨ã¦ã®ãƒªã‚½ãƒ¼ã‚¹ãŒå‰Šé™¤ã•ã‚Œã¾ã™

---

## ğŸ“š è©³ç´°èª¬æ˜ï¼ˆä¸Šè¨˜ã§åˆ†ã‹ã‚‰ãªã„äººå‘ã‘ï¼‰

### AWS CLIã®åˆæœŸè¨­å®š

#### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

**Windowsã®å ´åˆ:**
```bash
winget install Amazon.AWSCLI
```

**macOSã®å ´åˆ:**
```bash
brew install awscli
```

**Linuxã®å ´åˆ:**
```bash
curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"
unzip awscliv2.zip
sudo ./aws/install
```

#### èªè¨¼è¨­å®š

**ã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã®å–å¾—:**
1. AWSã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ãƒ­ã‚°ã‚¤ãƒ³
2. ã€ŒIAMã€ã‚µãƒ¼ãƒ“ã‚¹ã‚’é–‹ã
3. ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ã€â†’ã‚ãªãŸã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’ã‚¯ãƒªãƒƒã‚¯
4. ã€Œã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£èªè¨¼æƒ…å ±ã€ã‚¿ãƒ–ã‚’ã‚¯ãƒªãƒƒã‚¯
5. ã€Œã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã®ä½œæˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯
6. ã€ŒAWS CLIã€ã‚’é¸æŠã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã‚’ä½œæˆ

**AWS CLIã®è¨­å®š:**
```bash
aws configure
# AWS Access Key ID [None]: ã‚ãªãŸã®ã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ID
# AWS Secret Access Key [None]: ã‚ãªãŸã®ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼
# Default region name [None]: ap-northeast-1  # æ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³
# Default output format [None]: json
```

**è¨­å®šç¢ºèª:**
```bash
aws sts get-caller-identity
```

#### å¿…è¦ãªIAMæ¨©é™

```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": [
                "cloudformation:*",
                "sagemaker:*",
                "ec2:*",
                "iam:*",
                "logs:*"
            ],
            "Resource": "*"
        }
    ]
}
```

### ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ—ãƒ­ã‚»ã‚¹è©³ç´°

#### ä½œæˆé †åºã¨æ™‚é–“
1. **VPCä½œæˆ**ï¼ˆç´„1åˆ†ï¼‰: ã‚ãªãŸå°‚ç”¨ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç’°å¢ƒ
2. **ã‚µãƒ–ãƒãƒƒãƒˆãƒ»ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ä½œæˆ**ï¼ˆç´„1åˆ†ï¼‰: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã¸ã®çµŒè·¯è¨­å®š
3. **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆ**ï¼ˆç´„30ç§’ï¼‰: HTTPSã‚¢ã‚¯ã‚»ã‚¹ã®ã¿è¨±å¯
4. **IAMãƒ­ãƒ¼ãƒ«ä½œæˆ**ï¼ˆç´„30ç§’ï¼‰: SageMakerã®å®Ÿè¡Œæ¨©é™
5. **SageMakerãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ä½œæˆ**ï¼ˆç´„5-7åˆ†ï¼‰: ãƒ¡ã‚¤ãƒ³ã®æ©Ÿæ¢°å­¦ç¿’ç’°å¢ƒ

#### ãƒ‡ãƒ—ãƒ­ã‚¤çŠ¶æ³ç¢ºèªæ–¹æ³•

**é€²è¡ŒçŠ¶æ³ç¢ºèª:**
```bash
aws cloudformation describe-stack-events \
  --stack-name my-sagemaker-notebook \
  --region ap-northeast-1 \
  --query 'StackEvents[?ResourceType==`AWS::SageMaker::NotebookInstance`].[Timestamp,ResourceStatus,ResourceStatusReason]' \
  --output table
```

**ãƒ‡ãƒ—ãƒ­ã‚¤ä¸­ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹:**
- `CREATE_IN_PROGRESS`: ä½œæˆä¸­ï¼ˆ5-10åˆ†ï¼‰
- `CREATE_COMPLETE`: ä½œæˆå®Œäº†
- `CREATE_FAILED`: ä½œæˆå¤±æ•—
- `ROLLBACK_IN_PROGRESS`: ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ä¸­ï¼ˆ2-5åˆ†ï¼‰

### ã‚¢ã‚¯ã‚»ã‚¹è©³ç´°

#### ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„å ´åˆã®ãƒã‚§ãƒƒã‚¯

**ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®çŠ¶æ…‹ç¢ºèª:**
```bash
aws sagemaker describe-notebook-instance \
  --notebook-instance-name my-first-sagemaker-notebook \
  --region ap-northeast-1 \
  --query '[NotebookInstanceStatus,Url]' \
  --output table
```

**çŠ¶æ…‹ã®æ„å‘³:**
- âœ… **`InService`**: ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½çŠ¶æ…‹
- â³ **`Pending`**: èµ·å‹•ä¸­ï¼ˆã‚ã¨3-5åˆ†å¾…ã¤ï¼‰
- â›” **`Stopped`**: åœæ­¢ä¸­ï¼ˆå†é–‹ãŒå¿…è¦ï¼‰
- âŒ **`Failed`**: ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿï¼ˆãƒ­ã‚°ç¢ºèªãŒå¿…è¦ï¼‰

#### åˆå›ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã®ãŠã™ã™ã‚ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

1. **ã‚µãƒ³ãƒ—ãƒ«ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚’é–‹ã**
   - `SageMaker Examples` â†’ `Introduction to Machine Learning` â†’ `Getting Started`

2. **æ–°ã—ã„ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚’ä½œæˆ**
   - `+` ãƒœã‚¿ãƒ³ â†’ `Python 3` ã‚«ãƒ¼ãƒãƒ«ã‚’é¸æŠ

3. **ç°¡å˜ãªã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãƒ†ã‚¹ãƒˆ**
   ```python
   import pandas as pd
   import numpy as np
   import sagemaker
   
   print("SageMakerãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™!")
   print(f"SageMakerãƒãƒ¼ã‚¸ãƒ§ãƒ³: {sagemaker.__version__}")
   ```

### ãƒã‚¹ãƒˆã‚¹ã‚¿ãƒƒã‚¯è©³ç´°

#### ãªãœS3ãŒå¿…è¦ï¼Ÿ
ãƒã‚¹ãƒˆã‚¹ã‚¿ãƒƒã‚¯ã§ã¯ã€å­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’S3ã«é…ç½®ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€CloudFormationãŒå„ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

#### ãƒã‚¹ãƒˆã‚¹ã‚¿ãƒƒã‚¯ã®åˆ©ç‚¹
- **ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–**: å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ç‹¬ç«‹ã—ã¦ç®¡ç†
- **å†åˆ©ç”¨æ€§**: ä»–ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã‚‚éƒ¨åˆ†çš„ã«å†åˆ©ç”¨å¯èƒ½
- **ä¿å®ˆæ€§**: å¤‰æ›´æ™‚ã®å½±éŸ¿ç¯„å›²ã‚’é™å®š
- **ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£**: å¤§è¦æ¨¡ãªç’°å¢ƒã§ã‚‚ç®¡ç†ã—ã‚„ã™ã„

#### ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ
```
â”œâ”€â”€ main-stack.yaml                    # ãƒ¡ã‚¤ãƒ³ã‚¹ã‚¿ãƒƒã‚¯
â”œâ”€â”€ simple-stack.yaml                  # ã‚·ãƒ³ãƒ—ãƒ«ãªå˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ç‰ˆ
â”œâ”€â”€ templates/
â”‚   â”œâ”€â”€ vpc-stack.yaml                # VPCãƒ»ã‚µãƒ–ãƒãƒƒãƒˆç®¡ç†
â”‚   â”œâ”€â”€ iam-role-stack.yaml           # IAMãƒ­ãƒ¼ãƒ«ç®¡ç†
â”‚   â”œâ”€â”€ security-group-stack.yaml     # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†
â”‚   â”œâ”€â”€ custom-resource-stack.yaml    # ã‚«ã‚¹ã‚¿ãƒ ãƒªã‚½ãƒ¼ã‚¹ï¼ˆLambdaï¼‰
â”‚   â””â”€â”€ sagemaker-notebook-stack.yaml # SageMakerãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯
â””â”€â”€ README.md                          # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
```

### ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

#### ã‚ˆãã‚ã‚‹å•é¡Œ

**1. ãƒ‡ãƒ—ãƒ­ã‚¤ãŒå¤±æ•—ã™ã‚‹**
```bash
# ã‚¨ãƒ©ãƒ¼è©³ç´°ã‚’ç¢ºèª
aws cloudformation describe-stack-events \
  --stack-name my-sagemaker-notebook \
  --region ap-northeast-1
```

**2. Jupyter Notebookã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„**
- ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒã€ŒInServiceã€çŠ¶æ…‹ã‹ç¢ºèª
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã®è¨­å®šã‚’ç¢ºèª
- æ­£ã—ã„URLã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã‹ç¢ºèª

**3. æ¨©é™ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹**
- IAMãƒ­ãƒ¼ãƒ«ã®è¨­å®šã‚’ç¢ºèª
- å¿…è¦ãªæ¨©é™ãŒä»˜ä¸ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

#### ã‚µãƒãƒ¼ãƒˆ
å•é¡ŒãŒè§£æ±ºã—ãªã„å ´åˆã¯ã€AWSã®ã‚µãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ãƒ©ãƒ ã‚„å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

---

## ğŸ¯ ã‚µãƒ³ãƒ—ãƒ«å®Ÿè¡Œã¯ä»¥ä¸Šã§ã™

ã“ã“ã¾ã§ã§ã€SageMakerãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã®ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ»ã‚¢ã‚¯ã‚»ã‚¹ãƒ»ç®¡ç†ã®åŸºæœ¬çš„ãªæµã‚Œã‚’ä½“é¨“ã§ãã¾ã—ãŸã€‚

## ğŸš€ é‹ç”¨ã«å‘ã‘ãŸãƒ–ãƒ©ãƒƒã‚·ãƒ¥ã‚¢ãƒƒãƒ—ãƒã‚¤ãƒ³ãƒˆ

ã“ã®ã‚µãƒ³ãƒ—ãƒ«ã¯å­¦ç¿’ãƒ»æ¤œè¨¼ç”¨ã§ã™ã€‚**æœ¬æ ¼çš„ãªé‹ç”¨ç’°å¢ƒã§ã¯ä»¥ä¸‹ã®æ”¹å–„ã‚’å®Ÿè£…ã™ã‚‹ã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã«æ²¿ã£ãŸé‹ç”¨ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ï¼š**

### ğŸ”§ ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆæ”¹å–„

| é …ç›® | ç¾çŠ¶ | æ”¹å–„æ¡ˆ | ç†ç”± |
|------|------|--------|------|
| **ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³•** | æ‰‹å‹•ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ | ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆåŒ– | äººçš„ãƒŸã‚¹ã®å‰Šæ¸›ã€ä½œæ¥­åŠ¹ç‡åŒ– |
| **ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç®¡ç†** | ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ« | S3ã§ã®ç®¡ç† | ãƒãƒ¼ã‚¸ãƒ§ãƒ³å±¥æ­´ã€å·®åˆ†ç¢ºèªã€ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ |
| **ç’°å¢ƒç®¡ç†** | å˜ä¸€ç’°å¢ƒ | ç’°å¢ƒåˆ¥ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ« | dev/staging/prodç’°å¢ƒã®åˆ†é›¢ |
| **æ¤œè¨¼** | æ‰‹å‹•ç¢ºèª | ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè‡ªå‹•æ¤œè¨¼ | æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ã‚„ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹é•åã®æ—©æœŸç™ºè¦‹ |

### ğŸ›¡ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–

| é …ç›® | ç¾çŠ¶ | æ”¹å–„æ¡ˆ | ç†ç”± |
|------|------|--------|------|
| **æ©Ÿå¯†æƒ…å ±ç®¡ç†** | ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ« | AWS Secrets Manager | APIã‚­ãƒ¼ã‚„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®å®‰å…¨ãªç®¡ç† |
| **æš—å·åŒ–** | åŸºæœ¬è¨­å®š | KMSæš—å·åŒ– | ãƒ‡ãƒ¼ã‚¿ã®ä¿è­·å¼·åŒ– |
| **ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡** | åŸºæœ¬çš„ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ— | è©³ç´°ãªIAMãƒãƒªã‚·ãƒ¼ | æœ€å°æ¨©é™ã®åŸå‰‡ |
| **å‰Šé™¤ä¿è­·** | ãªã— | Stack Policy | èª¤å‰Šé™¤ã®é˜²æ­¢ |

### ğŸ“Š ç›£è¦–ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆ

| é …ç›® | ç¾çŠ¶ | æ”¹å–„æ¡ˆ | ç†ç”± |
|------|------|--------|------|
| **çŠ¶æ…‹ç›£è¦–** | æ‰‹å‹•ç¢ºèª | CloudWatch ã‚¢ãƒ©ãƒ¼ãƒ  | è‡ªå‹•çš„ãªå•é¡Œæ¤œçŸ¥ |
| **é€šçŸ¥** | ãªã— | SNSé€šçŸ¥ | å•é¡Œç™ºç”Ÿæ™‚ã®è¿…é€Ÿãªå¯¾å¿œ |
| **ã‚³ã‚¹ãƒˆç›£è¦–** | æ‰‹å‹•ç¢ºèª | ã‚³ã‚¹ãƒˆã‚¢ãƒ©ãƒ¼ãƒ  | äºˆç®—è¶…éã®é˜²æ­¢ |
| **ãƒ‰ãƒªãƒ•ãƒˆæ¤œå‡º** | ãªã— | å®šæœŸçš„ãªãƒ‰ãƒªãƒ•ãƒˆæ¤œå‡º | è¨­å®šå¤‰æ›´ã®æ¤œçŸ¥ |

### ğŸš€ CI/CDçµ±åˆ

| é …ç›® | ç¾çŠ¶ | æ”¹å–„æ¡ˆ | ç†ç”± |
|------|------|--------|------|
| **ãƒ‡ãƒ—ãƒ­ã‚¤** | æ‰‹å‹•å®Ÿè¡Œ | GitHub Actions | è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ã€å“è³ªä¿è¨¼ |
| **ãƒ†ã‚¹ãƒˆ** | ãªã— | è‡ªå‹•ãƒ†ã‚¹ãƒˆ | å“è³ªä¿è¨¼ã€ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³é˜²æ­¢ |
| **æ‰¿èªãƒ—ãƒ­ã‚»ã‚¹** | ãªã— | ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆ | ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã€å¤‰æ›´ç®¡ç† |

### ğŸ’¾ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ»å¾©æ—§

| é …ç›® | ç¾çŠ¶ | æ”¹å–„æ¡ˆ | ç†ç”± |
|------|------|--------|------|
| **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—** | ãªã— | å®šæœŸçš„ãªã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ | ãƒ‡ãƒ¼ã‚¿ä¿è­·ã€ç½å®³å¾©æ—§ |
| **å¾©æ—§æ‰‹é †** | ãªã— | å¾©æ—§ã‚¹ã‚¯ãƒªãƒ—ãƒˆ | è¿…é€Ÿãªå¾©æ—§ |

### ğŸ—ï¸ å®Ÿè£…å„ªå…ˆåº¦

**Phase 1ï¼ˆã™ãã«å®Ÿè£…ï¼‰:**
- ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆåŒ–
- ç’°å¢ƒåˆ¥ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«
- S3ã§ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç®¡ç†

**Phase 2ï¼ˆä¸­æœŸï¼‰:**
- ç›£è¦–ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š
- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ¤œè¨¼
- ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è‡ªå‹•åŒ–

**Phase 3ï¼ˆé•·æœŸï¼‰:**
- CI/CDçµ±åˆ
- é«˜åº¦ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š
- ç½å®³å¾©æ—§è¨ˆç”»

## ğŸ“ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã¯MITãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ä¸‹ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚