# SageMaker CloudFormation ã‚µãƒ³ãƒ—ãƒ«

ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã¯ã€AWS CloudFormationã‚’ä½¿ã£ã¦SageMakerãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç°¡å˜ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã‚µãƒ³ãƒ—ãƒ«ã§ã™ã€‚

## ğŸ¯ ã“ã®ã‚µãƒ³ãƒ—ãƒ«ã§ä½•ãŒã§ãã‚‹ã‹

**SageMakerãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯**ã¨ã„ã†æ©Ÿæ¢°å­¦ç¿’ã®é–‹ç™ºç’°å¢ƒã‚’ã€AWSã‚¯ãƒ©ã‚¦ãƒ‰ä¸Šã«è‡ªå‹•ã§æ§‹ç¯‰ã§ãã¾ã™ã€‚

### ä½œæˆã•ã‚Œã‚‹ã‚‚ã®
- **Jupyter Notebookç’°å¢ƒ**ï¼šãƒ–ãƒ©ã‚¦ã‚¶ã§æ©Ÿæ¢°å­¦ç¿’ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦å®Ÿè¡Œã§ãã‚‹
- **å¿…è¦ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­å®š**ï¼šå®‰å…¨ã«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ç’°å¢ƒ
- **æ¨©é™è¨­å®š**ï¼šSageMakerãŒä»–ã®AWSã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹è¨­å®š

### æƒ³å®šã™ã‚‹åˆ©ç”¨è€…
- æ©Ÿæ¢°å­¦ç¿’ã‚’å§‹ã‚ãŸã„æ–¹
- AWSã®SageMakerã‚’è©¦ã—ã¦ã¿ãŸã„æ–¹
- CloudFormationã®åŸºæœ¬çš„ãªä½¿ã„æ–¹ã‚’å­¦ã³ãŸã„æ–¹

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆï¼ˆåˆå¿ƒè€…å‘ã‘ï¼‰

### Step 1: äº‹å‰æº–å‚™

#### 1.1 AWSã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®å–å¾—
- [AWSå…¬å¼ã‚µã‚¤ãƒˆ](https://aws.amazon.com/)ã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ
- ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã®ç™»éŒ²ãŒå¿…è¦

#### 1.2 AWS CLIã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨è¨­å®š

**Windowsã®å ´åˆ:**
```bash
# AWS CLIã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
winget install Amazon.AWSCLI

# ã¾ãŸã¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
# https://awscli.amazonaws.com/AWSCLIV2.msi
```

**macOSã®å ´åˆ:**
```bash
# Homebrewã‚’ä½¿ç”¨
brew install awscli

# ã¾ãŸã¯ç›´æ¥ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
curl "https://awscli.amazonaws.com/AWSCLIV2.pkg" -o "AWSCLIV2.pkg"
sudo installer -pkg AWSCLIV2.pkg -target /
```

**Linuxã®å ´åˆ:**
```bash
# æœ€æ–°ç‰ˆã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"
unzip awscliv2.zip
sudo ./aws/install
```

#### 1.3 AWS CLIã®è¨­å®š

**ã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã®å–å¾—:**
1. AWSã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ãƒ­ã‚°ã‚¤ãƒ³
2. ã€ŒIAMã€ã‚µãƒ¼ãƒ“ã‚¹ã‚’é–‹ã
3. ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ã€â†’ã‚ãªãŸã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’ã‚¯ãƒªãƒƒã‚¯
4. ã€Œã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£èªè¨¼æƒ…å ±ã€ã‚¿ãƒ–ã‚’ã‚¯ãƒªãƒƒã‚¯
5. ã€Œã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã®ä½œæˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯
6. ã€ŒAWS CLIã€ã‚’é¸æŠã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã‚’ä½œæˆ

**AWS CLIã®è¨­å®šã‚³ãƒãƒ³ãƒ‰:**
```bash
# è¨­å®šã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œ
aws configure

# ä»¥ä¸‹ã®æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼š
# AWS Access Key ID [None]: ã‚ãªãŸã®ã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ID
# AWS Secret Access Key [None]: ã‚ãªãŸã®ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼
# Default region name [None]: ap-northeast-1  # æ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³
# Default output format [None]: json
```

**è¨­å®šã®ç¢ºèª:**
```bash
# è¨­å®šãŒæ­£ã—ãã§ãã¦ã„ã‚‹ã‹ç¢ºèª
aws sts get-caller-identity

# ä»¥ä¸‹ã®ã‚ˆã†ãªå‡ºåŠ›ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°æˆåŠŸï¼š
# {
#     "UserId": "AIDAXXXXXXXXXXXXXXXX",
#     "Account": "123456789012",
#     "Arn": "arn:aws:iam::123456789012:user/your-username"
# }
```

#### 1.4 å¿…è¦ãªæ¨©é™ã®è¨­å®š

ã“ã®ã‚µãƒ³ãƒ—ãƒ«ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ã¯ã€ä»¥ä¸‹ã®æ¨©é™ãŒå¿…è¦ã§ã™ï¼š

```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": [
                "cloudformation:*",
                "sagemaker:*",
                "ec2:*",
                "iam:*",
                "logs:*"
            ],
            "Resource": "*"
        }
    ]
}
```

ğŸ“ **åˆå¿ƒè€…ã®æ–¹ã¸**: æœ€åˆã¯ç®¡ç†è€…æ¨©é™ã§å§‹ã‚ã¦ã€æ…¢ã‚Œã¦ããŸã‚‰å¿…è¦æœ€å°é™ã®æ¨©é™ã«å¤‰æ›´ã™ã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚

### Step 2: ç°¡å˜ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# 1. ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
git clone <this-repo>
cd sagemaker-sample

# 2. ãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿè¡Œï¼ˆç´„10åˆ†ï¼‰
aws cloudformation create-stack \
  --stack-name my-sagemaker-notebook \
  --template-body file://simple-stack.yaml \
  --parameters file://simple-parameters.json \
  --capabilities CAPABILITY_NAMED_IAM \
  --region ap-northeast-1

# 3. ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†ã‚’å¾…ã¤
aws cloudformation wait stack-create-complete \
  --stack-name my-sagemaker-notebook \
  --region ap-northeast-1

# 4. çµæœã‚’ç¢ºèª
aws cloudformation describe-stacks \
  --stack-name my-sagemaker-notebook \
  --region ap-northeast-1 \
  --query 'Stacks[0].Outputs'
```

### ğŸ” ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ—ãƒ­ã‚»ã‚¹ã®è©³ç´°è§£èª¬

#### ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã§ä½•ãŒèµ·ã“ã£ã¦ã„ã‚‹ã‹

**1. VPCã®ä½œæˆï¼ˆç´„1åˆ†ï¼‰**
```bash
# é€²è¡ŒçŠ¶æ³ã‚’ç¢ºèª
aws cloudformation describe-stack-events \
  --stack-name my-sagemaker-notebook \
  --region ap-northeast-1 \
  --query 'StackEvents[?ResourceType==`AWS::EC2::VPC`].[Timestamp,ResourceStatus,ResourceStatusReason]' \
  --output table
```
- ã‚ãªãŸå°‚ç”¨ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç’°å¢ƒã‚’ä½œæˆ
- IPã‚¢ãƒ‰ãƒ¬ã‚¹ç¯„å›²ï¼ˆ10.0.0.0/16ï¼‰ã‚’è¨­å®š

**2. ã‚µãƒ–ãƒãƒƒãƒˆã¨ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®ä½œæˆï¼ˆç´„1åˆ†ï¼‰**
```bash
# ã‚µãƒ–ãƒãƒƒãƒˆã®ä½œæˆçŠ¶æ³ã‚’ç¢ºèª
aws cloudformation describe-stack-events \
  --stack-name my-sagemaker-notebook \
  --region ap-northeast-1 \
  --query 'StackEvents[?ResourceType==`AWS::EC2::Subnet`].[Timestamp,ResourceStatus]' \
  --output table
```
- ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆã®ä½œæˆ
- ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã¸ã®çµŒè·¯è¨­å®š

**3. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã®ä½œæˆï¼ˆç´„30ç§’ï¼‰**
```bash
# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã®ä½œæˆçŠ¶æ³ã‚’ç¢ºèª
aws cloudformation describe-stack-events \
  --stack-name my-sagemaker-notebook \
  --region ap-northeast-1 \
  --query 'StackEvents[?ResourceType==`AWS::EC2::SecurityGroup`].[Timestamp,ResourceStatus]' \
  --output table
```
- HTTPSã‚¢ãƒ†ã‚¯ã‚»ã‚¹ã®ã¿è¨±å¯ã™ã‚‹ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®š

**4. IAMãƒ­ãƒ¼ãƒ«ã®ä½œæˆï¼ˆç´„30ç§’ï¼‰**
```bash
# IAMãƒ­ãƒ¼ãƒ«ã®ä½œæˆçŠ¶æ³ã‚’ç¢ºèª
aws cloudformation describe-stack-events \
  --stack-name my-sagemaker-notebook \
  --region ap-northeast-1 \
  --query 'StackEvents[?ResourceType==`AWS::IAM::Role`].[Timestamp,ResourceStatus]' \
  --output table
```
- SageMakerãŒä»–ã®AWSã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«æ¨©é™è¨­å®š

**5. SageMakerãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ä½œæˆï¼ˆç´„5-7åˆ†ï¼‰**
```bash
# SageMakerãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã®ä½œæˆçŠ¶æ³ã‚’ç¢ºèª
aws cloudformation describe-stack-events \
  --stack-name my-sagemaker-notebook \
  --region ap-northeast-1 \
  --query 'StackEvents[?ResourceType==`AWS::SageMaker::NotebookInstance`].[Timestamp,ResourceStatus,ResourceStatusReason]' \
  --output table
```
- ãƒ¡ã‚¤ãƒ³ã®æ©Ÿæ¢°å­¦ç¿’ç’°å¢ƒã‚’ä½œæˆ
- ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ãŒæœ€ã‚‚æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™

#### ãƒ‡ãƒ—ãƒ­ã‚¤çŠ¶æ³ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–

```bash
# å…¨ä½“ã®é€²è¡ŒçŠ¶æ³ã‚’ç¢ºèª
aws cloudformation describe-stacks \
  --stack-name my-sagemaker-notebook \
  --region ap-northeast-1 \
  --query 'Stacks[0].StackStatus'

# æœ€æ–°ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¡¨ç¤ºï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–ï¼‰
watch -n 10 'aws cloudformation describe-stack-events \
  --stack-name my-sagemaker-notebook \
  --region ap-northeast-1 \
  --query "StackEvents[0:3].[Timestamp,ResourceType,ResourceStatus,ResourceStatusReason]" \
  --output table'
```

#### ãƒ‡ãƒ—ãƒ­ã‚¤ä¸­ã«ç™ºç”Ÿã—ã†ã‚‹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹

| ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | æ„å‘³ | ç¶šè¡Œæ™‚é–“ |
|---------|------|----------|
| `CREATE_IN_PROGRESS` | ä½œæˆä¸­ | 5-10åˆ† |
| `CREATE_COMPLETE` | ä½œæˆå®Œäº† | - |
| `CREATE_FAILED` | ä½œæˆå¤±æ•— | - |
| `ROLLBACK_IN_PROGRESS` | ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ä¸­ | 2-5åˆ† |

#### ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†ã®ç¢ºèª

```bash
# ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†å¾Œã®å‡ºåŠ›ã‚’ç¢ºèª
aws cloudformation describe-stacks \
  --stack-name my-sagemaker-notebook \
  --region ap-northeast-1 \
  --query 'Stacks[0].Outputs[*].[OutputKey,OutputValue,Description]' \
  --output table
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã§ä»¥ä¸‹ã®æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼š
- **NotebookInstanceName**: ä½œæˆã•ã‚ŒãŸãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã®åå‰
- **JupyterURL**: Jupyterãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹URL
- **VpcId**: ä½œæˆã•ã‚ŒãŸVPCã®ID
- **ImportantNote**: ã‚³ã‚¹ãƒˆã«é–¢ã™ã‚‹é‡è¦ãªæ³¨æ„äº‹é …

### Step 3: ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•

#### 3.1 ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†å¾Œã®ç¢ºèª

```bash
# ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†å¾Œã€ã‚¢ã‚¯ã‚»ã‚¹URLã‚’å–å¾—
aws cloudformation describe-stacks \
  --stack-name my-sagemaker-notebook \
  --region ap-northeast-1 \
  --query 'Stacks[0].Outputs[*].[OutputKey,OutputValue]' \
  --output table
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã§ä»¥ä¸‹ã®ã‚ˆã†ãªURLãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼š

```
+-------------------+----------------------------------------------------------------+
|   OutputKey       |                    OutputValue                                 |
+-------------------+----------------------------------------------------------------+
| JupyterURL        | https://console.aws.amazon.com/sagemaker/home?region=ap-...   |
| DirectJupyterURL  | https://my-first-sagemaker-notebook.notebook.ap-northeast-... |
| JupyterLabURL     | https://my-first-sagemaker-notebook.notebook.ap-northeast-... |
+-------------------+----------------------------------------------------------------+
```

#### 3.2 ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•ï¼ˆæ¨å¥¨æ‰‹é †ï¼‰

**æ–¹æ³•A: AWSã‚³ãƒ³ã‚½ãƒ¼ãƒ«çµŒç”±ï¼ˆåˆå¿ƒè€…æ¨å¥¨ï¼‰**

1. **ä¸Šè¨˜ã®`JupyterURL`ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ã**
2. **AWSã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ãƒ­ã‚°ã‚¤ãƒ³**
3. **ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒã€ŒInServiceã€ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª**
4. **ã€ŒOpen JupyterLabã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯**

**æ–¹æ³•B: ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆä¸Šç´šè€…å‘ã‘ï¼‰**

1. **ä¸Šè¨˜ã®`JupyterLabURL`ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§ç›´æ¥é–‹ã**
2. **AWSã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª**

#### 3.3 ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã®æ³¨æ„äº‹é …

âš ï¸ **ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„å ´åˆã®ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ**

```bash
# ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®çŠ¶æ…‹ã‚’ç¢ºèª
aws sagemaker describe-notebook-instance \
  --notebook-instance-name my-first-sagemaker-notebook \
  --region ap-northeast-1 \
  --query '[NotebookInstanceStatus,Url]' \
  --output table
```

- âœ… **`InService`**: ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½çŠ¶æ…‹
- â³ **`Pending`**: èµ·å‹•ä¸­ï¼ˆã‚ã¨3-5åˆ†å¾…ã¤ï¼‰
- â›” **`Stopped`**: åœæ­¢ä¸­ï¼ˆå†é–‹ãŒå¿…è¦ï¼‰
- âŒ **`Failed`**: ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿï¼ˆãƒ­ã‚°ç¢ºèªãŒå¿…è¦ï¼‰

#### 3.4 ã‚¢ã‚¯ã‚»ã‚¹æˆåŠŸæ™‚ã®ç”»é¢

ã‚¢ã‚¯ã‚»ã‚¹ãŒæˆåŠŸã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªJupyterLabç’°å¢ƒãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼š

- âœ… **å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼**: ãƒ•ã‚¡ã‚¤ãƒ«ãƒ–ãƒ©ã‚¦ã‚¶
- âœ… **ãƒ¡ã‚¤ãƒ³ã‚¨ãƒªã‚¢**: ã‚³ãƒ¼ãƒ‰ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼
- âœ… **SageMaker Examples**: AWSå…¬å¼ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ãŒåˆ©ç”¨å¯èƒ½
- âœ… **ãƒ—ãƒªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ©ã‚¤ãƒ–ãƒ©ãƒª**: TensorFlowã€PyTorchã€Scikit-learnãªã©

#### 3.5 åˆå›ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã®ãŠã™ã™ã‚ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

1. **ã‚µãƒ³ãƒ—ãƒ«ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚’é–‹ã**
   - `SageMaker Examples` â†’ `Introduction to Machine Learning` â†’ `Getting Started`

2. **æ–°ã—ã„ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚’ä½œæˆ**
   - `+` ãƒœã‚¿ãƒ³ â†’ `Python 3` ã‚«ãƒ¼ãƒãƒ«ã‚’é¸æŠ

3. **ç°¡å˜ãªã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãƒ†ã‚¹ãƒˆ**
   ```python
   import pandas as pd
   import numpy as np
   import sagemaker
   
   print("SageMakerãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™!")
   print(f"SageMakerãƒãƒ¼ã‚¸ãƒ§ãƒ³: {sagemaker.__version__}")
   ```

## ğŸ“Š ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        AWS Cloud                           â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    VPC                              â”‚   â”‚
â”‚  â”‚  (10.0.0.0/16)                                     â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚           Public Subnet                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚          (10.0.1.0/24)                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                             â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚      SageMaker Notebook             â”‚   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚                                     â”‚   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  - Jupyter Labç’°å¢ƒ                 â”‚   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  - ml.t3.medium                    â”‚   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  - æ©Ÿæ¢°å­¦ç¿’ãƒ©ã‚¤ãƒ–ãƒ©ãƒª               â”‚   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚        Security Group                       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                             â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - HTTPSã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ (ãƒãƒ¼ãƒˆ443)           â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - Jupyter Notebookã¸ã®å®‰å…¨ãªã‚¢ã‚¯ã‚»ã‚¹      â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                IAM Role                             â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚  - SageMakerã®å®Ÿè¡Œæ¨©é™                             â”‚   â”‚
â”‚  â”‚  - S3ã€CloudWatchç­‰ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ HTTPS (443)
                                â”‚
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚                 â”‚
                      â”‚   ã‚ãªãŸã®PC     â”‚
                      â”‚                 â”‚
                      â”‚  ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰    â”‚
                      â”‚  Jupyteræ¥ç¶š     â”‚
                      â”‚                 â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ’¡ å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®èª¬æ˜ï¼ˆä½œæˆé †åºï¼‰

### 1. VPC (Virtual Private Cloud) ğŸ 
- **å½¹å‰²**: ã‚ãªãŸå°‚ç”¨ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç’°å¢ƒ
- **ãªãœå¿…è¦**: å¤–éƒ¨ã‹ã‚‰ã®ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹ã‚’é˜²ããŸã‚
- **è¨­å®š**: ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ç¯„å›²ï¼ˆ10.0.0.0/16ï¼‰
- **ä½œæˆæ™‚é–“**: ç´„30ç§’

### 2. ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ ğŸŒ
- **å½¹å‰²**: VPCã¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚’ç¹‹ãå‡ºå…¥ã‚Šå£
- **ãªãœå¿…è¦**: ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚
- **è¨­å®š**: è‡ªå‹•è¨­å®š
- **ä½œæˆæ™‚é–“**: ç´„30ç§’

### 3. ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆ ğŸ“
- **å½¹å‰²**: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªã‚¨ãƒªã‚¢
- **ãªãœå¿…è¦**: Jupyter Notebookã«ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚
- **è¨­å®š**: VPCã®ä¸€éƒ¨ï¼ˆ10.0.1.0/24ï¼‰
- **ä½œæˆæ™‚é–“**: ç´„30ç§’

### 4. ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã¨ãƒ«ãƒ¼ãƒˆ ğŸ—ºï¸
- **å½¹å‰²**: ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®é“ç­‹ã‚’æ±ºã‚ã‚‹è¨­å®š
- **ãªãœå¿…è¦**: ã‚µãƒ–ãƒãƒƒãƒˆã‹ã‚‰ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã¸ã®çµŒè·¯ã‚’ä½œã‚‹ãŸã‚
- **è¨­å®š**: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤çµŒç”±ã§å…¨ã¦ã®é€šä¿¡ã‚’è¨±å¯
- **ä½œæˆæ™‚é–“**: ç´„30ç§’

### 5. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ— ğŸ”’
- **å½¹å‰²**: ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ï¼ˆé€šä¿¡ã®è¨±å¯ãƒ»æ‹’å¦ï¼‰
- **ãªãœå¿…è¦**: å¿…è¦ãªé€šä¿¡ã®ã¿ã‚’è¨±å¯ã—ã¦å®‰å…¨æ€§ã‚’ç¢ºä¿
- **è¨­å®š**: HTTPSï¼ˆãƒãƒ¼ãƒˆ443ï¼‰ã®ã¿è¨±å¯
- **ä½œæˆæ™‚é–“**: ç´„30ç§’

### 6. IAMãƒ­ãƒ¼ãƒ« ğŸ”‘
- **å½¹å‰²**: SageMakerãŒAWSã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ã†æ™‚ã®æ¨©é™
- **ãªãœå¿…è¦**: ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿æ›¸ãã‚„ãƒ­ã‚°å‡ºåŠ›ã«å¿…è¦
- **è¨­å®š**: SageMakerã®åŸºæœ¬æ¨©é™ï¼ˆS3ã€CloudWatchç­‰ï¼‰
- **ä½œæˆæ™‚é–“**: ç´„30ç§’

### 7. SageMakerãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ ğŸ“Š
- **å½¹å‰²**: æ©Ÿæ¢°å­¦ç¿’ã®é–‹ç™ºç’°å¢ƒï¼ˆãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼‰
- **ãªãœå¿…è¦**: ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦å®Ÿè¡Œã™ã‚‹ãŸã‚
- **è¨­å®š**: 
  - ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ—: ml.t3.mediumï¼ˆå°ã•ãªã‚µã‚¤ã‚ºï¼‰
  - ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸: 20GB
  - ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰: AWSå…¬å¼ãƒªãƒã‚¸ãƒˆãƒªãŒè‡ªå‹•ã§åˆ©ç”¨å¯èƒ½
- **ä½œæˆæ™‚é–“**: ç´„5-7åˆ†ï¼ˆæœ€ã‚‚æ™‚é–“ãŒã‹ã‹ã‚‹ï¼‰

### ğŸ”„ ä½œæˆé †åºã®ç†ç”±
1. **ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åŸºç›¤ã‹ã‚‰ä½œæˆ**: VPCâ†’ã‚µãƒ–ãƒãƒƒãƒˆâ†’ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
2. **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã§ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
3. **æ¨©é™è¨­å®š**: IAMãƒ­ãƒ¼ãƒ«ã§ã‚µãƒ¼ãƒ“ã‚¹é–“ã®æ¨©é™ã‚’è¨­å®š
4. **ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹**: æœ€å¾Œã«SageMakerãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚’ä½œæˆ

## ğŸ’° ã‚³ã‚¹ãƒˆæƒ…å ±

### æƒ³å®šã‚³ã‚¹ãƒˆï¼ˆæ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ï¼‰
- **SageMakerãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ï¼ˆml.t3.mediumï¼‰**: ç´„ $0.06/æ™‚é–“
- **EBSã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ï¼ˆ20GBï¼‰**: ç´„ $0.05/æ—¥
- **ãã®ä»–ï¼ˆVPCã€NAT Gatewayç­‰ï¼‰**: ç´„ $0.05/æ—¥

### ğŸ’¡ ã‚³ã‚¹ãƒˆå‰Šæ¸›ã®ãƒã‚¤ãƒ³ãƒˆ
1. **ä½¿ã‚ãªã„æ™‚ã¯åœæ­¢**: ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’åœæ­¢ã™ã‚Œã°ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è²»ç”¨ã¯ç™ºç”Ÿã—ã¾ã›ã‚“
2. **ä¸è¦ã«ãªã£ãŸã‚‰å‰Šé™¤**: ã‚¹ã‚¿ãƒƒã‚¯å…¨ä½“ã‚’å‰Šé™¤ã™ã‚Œã°å…¨ã¦ã®ãƒªã‚½ãƒ¼ã‚¹ãŒå‰Šé™¤ã•ã‚Œã¾ã™

## ğŸ› ï¸ ä½¿ã„æ–¹

### ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®æ“ä½œ

#### åœæ­¢æ–¹æ³•
```bash
# ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‹ã‚‰åœæ­¢
aws sagemaker stop-notebook-instance \
  --notebook-instance-name my-first-sagemaker-notebook \
  --region ap-northeast-1
```

#### å†é–‹æ–¹æ³•
```bash
# ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‹ã‚‰å†é–‹
aws sagemaker start-notebook-instance \
  --notebook-instance-name my-first-sagemaker-notebook \
  --region ap-northeast-1
```

#### å‰Šé™¤æ–¹æ³•
```bash
# ã‚·ãƒ³ãƒ—ãƒ«ã‚¹ã‚¿ãƒƒã‚¯ã‚’å‰Šé™¤
aws cloudformation delete-stack \
  --stack-name my-sagemaker-notebook \
  --region ap-northeast-1

# è¤‡æ•°ã®ã‚¹ã‚¿ãƒƒã‚¯ã‚’å‰Šé™¤ã™ã‚‹å ´åˆ
# 1ã¤ç›®ã®ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ï¼ˆé–‹ç™ºç”¨ï¼‰ã‚’å‰Šé™¤
aws cloudformation delete-stack \
  --stack-name sagemaker-notebook-dev \
  --region ap-northeast-1

# 2ã¤ç›®ã®ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ï¼ˆæœ¬ç•ªç”¨ï¼‰ã‚’å‰Šé™¤
aws cloudformation delete-stack \
  --stack-name sagemaker-notebook-prod \
  --region ap-northeast-1
```

#### ä¸€æ‹¬å‰Šé™¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

```bash
# å…¨ã¦ã®sagemakeré–¢é€£ã‚¹ã‚¿ãƒƒã‚¯ã‚’ä¸€æ‹¬å‰Šé™¤
for stack in $(aws cloudformation list-stacks \
  --region ap-northeast-1 \
  --query 'StackSummaries[?contains(StackName, `sagemaker`) && StackStatus != `DELETE_COMPLETE`].StackName' \
  --output text); do
  echo "Deleting stack: $stack"
  aws cloudformation delete-stack --stack-name $stack --region ap-northeast-1
done

# å‰Šé™¤å®Œäº†ã‚’ç¢ºèª
aws cloudformation list-stacks \
  --region ap-northeast-1 \
  --query 'StackSummaries[?contains(StackName, `sagemaker`)].{Name:StackName,Status:StackStatus}' \
  --output table
```

## ğŸ“ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### 1. ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œ
- ä½œæˆã•ã‚ŒãŸJupyter Notebookã§æ©Ÿæ¢°å­¦ç¿’ã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œ
- AWSå…¬å¼ã®ã‚µãƒ³ãƒ—ãƒ«ãŒè‡ªå‹•ã§åˆ©ç”¨å¯èƒ½

### 2. ç‹¬è‡ªã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆ
- æ–°ã—ã„Notebookã‚’ä½œæˆã—ã¦æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã‚’é–‹ç™º
- ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã€å‰å‡¦ç†ã€ãƒ¢ãƒ‡ãƒ«å­¦ç¿’ã€è©•ä¾¡ã‚’å®Ÿè¡Œ

### 3. è¤‡æ•°ã®ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚’ä½œæˆ

#### 3.1 ç•°ãªã‚‹ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚’ä½œæˆã™ã‚‹æ–¹æ³•

**æ–¹æ³•A: è¤‡æ•°ã®ã‚·ãƒ³ãƒ—ãƒ«ã‚¹ã‚¿ãƒƒã‚¯ã‚’ä½œæˆï¼ˆæ¨å¥¨ï¼‰**

```bash
# 1ã¤ç›®ã®ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ï¼ˆé–‹ç™ºç”¨ï¼‰
aws cloudformation create-stack \
  --stack-name sagemaker-notebook-dev \
  --template-body file://simple-stack.yaml \
  --parameters ParameterKey=NotebookInstanceName,ParameterValue=dev-notebook \
  --capabilities CAPABILITY_NAMED_IAM \
  --region ap-northeast-1

# 2ã¤ç›®ã®ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ï¼ˆæœ¬ç•ªç”¨ï¼‰
aws cloudformation create-stack \
  --stack-name sagemaker-notebook-prod \
  --template-body file://simple-stack.yaml \
  --parameters ParameterKey=NotebookInstanceName,ParameterValue=prod-notebook \
  --capabilities CAPABILITY_NAMED_IAM \
  --region ap-northeast-1
```

**æ–¹æ³•B: ãƒã‚¹ãƒˆã‚¹ã‚¿ãƒƒã‚¯ã§ä½œæˆï¼ˆä¸Šç´šè€…å‘ã‘ï¼‰**

```bash
# ãƒã‚¹ãƒˆã‚¹ã‚¿ãƒƒã‚¯æ§‹æˆã§ä½œæˆ
aws cloudformation create-stack \
  --stack-name sagemaker-notebook-nested \
  --template-body file://main-stack.yaml \
  --parameters ParameterKey=NotebookInstanceName,ParameterValue=nested-notebook \
  --capabilities CAPABILITY_NAMED_IAM \
  --region ap-northeast-1
```

#### 3.2 è¤‡æ•°ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã®åˆ©ç”¨ã‚·ãƒ¼ãƒ³

- **é–‹ç™ºç’°å¢ƒã¨æœ¬ç•ªç’°å¢ƒã®åˆ†é›¢**
- **ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼é–“ã§ã®ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯å…±æœ‰**
- **ç•°ãªã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚„å®Ÿé¨“ã®ä¸¦è¡Œå®Ÿè¡Œ**
- **ç•°ãªã‚‹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ—ã§ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ**

#### 3.3 è¤‡æ•°ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã®ç®¡ç†

```bash
# å…¨ã¦ã®ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚¹ã‚¿ãƒƒã‚¯ã‚’ä¸€è¦§è¡¨ç¤º
aws cloudformation list-stacks \
  --region ap-northeast-1 \
  --query 'StackSummaries[?contains(StackName, `sagemaker-notebook`)].{Name:StackName,Status:StackStatus}' \
  --output table

# å…¨ã¦ã®ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä¸€è¦§è¡¨ç¤º
aws sagemaker list-notebook-instances \
  --region ap-northeast-1 \
  --query 'NotebookInstances[*].{Name:NotebookInstanceName,Status:NotebookInstanceStatus,InstanceType:InstanceType}' \
  --output table
```

### 4. ã‚ˆã‚Šé«˜åº¦ãªæ§‹æˆã‚’å­¦ã¶
- è¤‡æ•°ã®ã‚µãƒ–ãƒãƒƒãƒˆã‚’ä½¿ã£ãŸæ§‹æˆ
- ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã§ã®å®Ÿè¡Œ
- ã‚«ã‚¹ã‚¿ãƒ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š

## ğŸ“ ä¸Šç´šè€…å‘ã‘ï¼šãƒã‚¹ãƒˆã‚¹ã‚¿ãƒƒã‚¯æ§‹æˆ

ã‚ˆã‚ŠæŸ”è»Ÿã§ç®¡ç†ã—ã‚„ã™ã„æ§‹æˆã‚’æ±‚ã‚ã‚‹å ´åˆã¯ã€ä»¥ä¸‹ã®ãƒã‚¹ãƒˆã‚¹ã‚¿ãƒƒã‚¯æ§‹æˆã‚‚åˆ©ç”¨ã§ãã¾ã™ï¼š

```
â”œâ”€â”€ main-stack.yaml                    # ãƒ¡ã‚¤ãƒ³ã‚¹ã‚¿ãƒƒã‚¯
â”œâ”€â”€ simple-stack.yaml                  # ã‚·ãƒ³ãƒ—ãƒ«ãªå˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ç‰ˆ
â”œâ”€â”€ templates/
â”‚   â”œâ”€â”€ vpc-stack.yaml                # VPCãƒ»ã‚µãƒ–ãƒãƒƒãƒˆç®¡ç†
â”‚   â”œâ”€â”€ iam-role-stack.yaml           # IAMãƒ­ãƒ¼ãƒ«ç®¡ç†
â”‚   â”œâ”€â”€ security-group-stack.yaml     # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†
â”‚   â”œâ”€â”€ custom-resource-stack.yaml    # ã‚«ã‚¹ã‚¿ãƒ ãƒªã‚½ãƒ¼ã‚¹ï¼ˆLambdaï¼‰
â”‚   â””â”€â”€ sagemaker-notebook-stack.yaml # SageMakerãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯
â””â”€â”€ README.md                          # è©³ç´°ãªä½¿ç”¨æ–¹æ³•ã¨ã‚¬ã‚¤ãƒ‰
```

### ãƒã‚¹ãƒˆã‚¹ã‚¿ãƒƒã‚¯ã®åˆ©ç‚¹
- **ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–**: å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ç‹¬ç«‹ã—ã¦ç®¡ç†
- **å†åˆ©ç”¨æ€§**: ä»–ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã‚‚éƒ¨åˆ†çš„ã«å†åˆ©ç”¨å¯èƒ½
- **ä¿å®ˆæ€§**: å¤‰æ›´æ™‚ã®å½±éŸ¿ç¯„å›²ã‚’é™å®š
- **ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£**: å¤§è¦æ¨¡ãªç’°å¢ƒã§ã‚‚ç®¡ç†ã—ã‚„ã™ã„

### åˆ©ç”¨æ–¹æ³•

#### äº‹å‰æº–å‚™ï¼ˆS3ãƒã‚±ãƒƒãƒˆã®ä½œæˆï¼‰
```bash
# ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ ¼ç´ç”¨ã®S3ãƒã‚±ãƒƒãƒˆã‚’ä½œæˆ
aws s3 mb s3://$(aws sts get-caller-identity --query Account --output text)-cfn-templates --region ap-northeast-1

# ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’S3ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
aws s3 cp templates/ s3://$(aws sts get-caller-identity --query Account --output text)-cfn-templates/sagemaker/templates/ --recursive --region ap-northeast-1
```

#### ãƒ‡ãƒ—ãƒ­ã‚¤
```bash
# ãƒã‚¹ãƒˆã‚¹ã‚¿ãƒƒã‚¯ã§ãƒ‡ãƒ—ãƒ­ã‚¤
aws cloudformation create-stack \
  --stack-name sagemaker-nested-example \
  --template-body file://main-stack.yaml \
  --parameters ParameterKey=NotebookInstanceName,ParameterValue=nested-notebook \
  --capabilities CAPABILITY_NAMED_IAM \
  --region ap-northeast-1
```

**ãªãœS3ãŒå¿…è¦ï¼Ÿ**
ãƒã‚¹ãƒˆã‚¹ã‚¿ãƒƒã‚¯ã§ã¯ã€å­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’S3ã«é…ç½®ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€CloudFormationãŒå„ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œ

#### 1. ãƒ‡ãƒ—ãƒ­ã‚¤ãŒå¤±æ•—ã™ã‚‹
```bash
# ã‚¨ãƒ©ãƒ¼è©³ç´°ã‚’ç¢ºèª
aws cloudformation describe-stack-events \
  --stack-name my-sagemaker-notebook \
  --region ap-northeast-1
```

#### 2. Jupyter Notebookã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„
- ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒã€ŒInServiceã€çŠ¶æ…‹ã‹ç¢ºèª
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã®è¨­å®šã‚’ç¢ºèª
- æ­£ã—ã„URLã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã‹ç¢ºèª

#### 3. æ¨©é™ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹
- IAMãƒ­ãƒ¼ãƒ«ã®è¨­å®šã‚’ç¢ºèª
- å¿…è¦ãªæ¨©é™ãŒä»˜ä¸ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

### ã‚µãƒãƒ¼ãƒˆ
å•é¡ŒãŒè§£æ±ºã—ãªã„å ´åˆã¯ã€AWSã®ã‚µãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ãƒ©ãƒ ã‚„å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## ğŸ“ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã¯MITãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ä¸‹ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚